<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 结构增长 | 红移畸变宇宙学研究</title>
  <meta name="description" content="4 结构增长 | 红移畸变宇宙学研究" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="4 结构增长 | 红移畸变宇宙学研究" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 结构增长 | 红移畸变宇宙学研究" />
  
  
  

<meta name="author" content="陈隽德 导师：张鹏杰  2021 @ 上海交通大学" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="宇宙学观测.html"/>
<link rel="next" href="附录.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">红移畸变宇宙学研究</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 简介</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#摘要"><i class="fa fa-check"></i><b>1.1</b> 摘要</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#abstract"><i class="fa fa-check"></i><b>1.2</b> abstract</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="宇宙学模型.html"><a href="宇宙学模型.html"><i class="fa fa-check"></i><b>2</b> 宇宙学模型</a>
<ul>
<li class="chapter" data-level="2.1" data-path="宇宙学模型.html"><a href="宇宙学模型.html#标准宇宙学模型"><i class="fa fa-check"></i><b>2.1</b> 标准宇宙学模型</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="宇宙学模型.html"><a href="宇宙学模型.html#宇宙的加速膨胀"><i class="fa fa-check"></i><b>2.1.1</b> 宇宙的加速膨胀</a></li>
<li class="chapter" data-level="2.1.2" data-path="宇宙学模型.html"><a href="宇宙学模型.html#宇宙的演化历史"><i class="fa fa-check"></i><b>2.1.2</b> 宇宙的演化历史</a></li>
<li class="chapter" data-level="2.1.3" data-path="宇宙学模型.html"><a href="宇宙学模型.html#标准宇宙学存在的问题"><i class="fa fa-check"></i><b>2.1.3</b> 标准宇宙学存在的问题</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="宇宙学模型.html"><a href="宇宙学模型.html#sec:beyond_lcdm"><i class="fa fa-check"></i><b>2.2</b> 非标准宇宙学模型</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="宇宙学模型.html"><a href="宇宙学模型.html#标准宇宙学的简单唯象推广"><i class="fa fa-check"></i><b>2.2.1</b> 标准宇宙学的简单唯象推广</a></li>
<li class="chapter" data-level="2.2.2" data-path="宇宙学模型.html"><a href="宇宙学模型.html#其他模型"><i class="fa fa-check"></i><b>2.2.2</b> 其他模型</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="宇宙学观测.html"><a href="宇宙学观测.html"><i class="fa fa-check"></i><b>3</b> 宇宙学观测</a>
<ul>
<li class="chapter" data-level="3.1" data-path="宇宙学观测.html"><a href="宇宙学观测.html#sec:observables"><i class="fa fa-check"></i><b>3.1</b> 宇宙学距离，本动速度与红移</a></li>
<li class="chapter" data-level="3.2" data-path="宇宙学观测.html"><a href="宇宙学观测.html#宇宙学探针"><i class="fa fa-check"></i><b>3.2</b> 宇宙学探针</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="宇宙学观测.html"><a href="宇宙学观测.html#宇宙微波背景辐射"><i class="fa fa-check"></i><b>3.2.1</b> 宇宙微波背景辐射</a></li>
<li class="chapter" data-level="3.2.2" data-path="宇宙学观测.html"><a href="宇宙学观测.html#sec:BAO"><i class="fa fa-check"></i><b>3.2.2</b> 重子声波振荡</a></li>
<li class="chapter" data-level="3.2.3" data-path="宇宙学观测.html"><a href="宇宙学观测.html#sec:rsd_intro"><i class="fa fa-check"></i><b>3.2.3</b> 红移畸变</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="结构增长.html"><a href="结构增长.html"><i class="fa fa-check"></i><b>4</b> 结构增长</a>
<ul>
<li class="chapter" data-level="4.1" data-path="结构增长.html"><a href="结构增长.html#sec:PT"><i class="fa fa-check"></i><b>4.1</b> 扰动理论</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="结构增长.html"><a href="结构增长.html#sec:ePT"><i class="fa fa-check"></i><b>4.1.1</b> 欧拉扰动理论</a></li>
<li class="chapter" data-level="4.1.2" data-path="结构增长.html"><a href="结构增长.html#sec:LPT"><i class="fa fa-check"></i><b>4.1.2</b> 拉格朗日扰动理论</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="结构增长.html"><a href="结构增长.html#n体数值模拟与非线性结构形成"><i class="fa fa-check"></i><b>4.2</b> N体数值模拟与非线性结构形成</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="结构增长.html"><a href="结构增长.html#n体数值模拟简介"><i class="fa fa-check"></i><b>4.2.1</b> N体数值模拟简介</a></li>
<li class="chapter" data-level="4.2.2" data-path="结构增长.html"><a href="结构增长.html#暗晕"><i class="fa fa-check"></i><b>4.2.2</b> 暗晕</a></li>
<li class="chapter" data-level="4.2.3" data-path="结构增长.html"><a href="结构增长.html#其他方法"><i class="fa fa-check"></i><b>4.2.3</b> 其他方法</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="附录.html"><a href="附录.html"><i class="fa fa-check"></i><b>5</b> 附录</a>
<ul>
<li class="chapter" data-level="5.1" data-path="附录.html"><a href="附录.html#符号对照表"><i class="fa fa-check"></i><b>5.1</b> 符号对照表</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">红移畸变宇宙学研究</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="结构增长" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> 结构增长<a href="结构增长.html#结构增长" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>物质的原初扰动在引力作用下，经历线性增长及非线性增长两个阶段，逐渐形成今天我们看到的大尺度结构。
在线性阶段，我们可以借助扰动理论计算结构增长。
当演化进入非线性阶段，扰动理论不再适用，需要借助其他方法如N体数值模拟对结构增长进行计算。</p>
<div id="sec:PT" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> 扰动理论<a href="结构增长.html#sec:PT" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>为简化方程的表达，下面我们在共动坐标系下讨论问题。
定义共形时间<span class="math inline">\(\tau\)</span>满足<span class="math inline">\(\rm{d} t=a(\tau)\rm{d} \tau\)</span>，
共形哈勃参数<span class="math inline">\(\mathscr{H}\equiv aH\)</span>，并用<span class="math inline">\({\bf x}\)</span>以及<span class="math inline">\({\bf v}\)</span>分别表示粒子的共动坐标，及共动坐标系下的本动速度。
则相空间中的物质分布函数<span class="math inline">\(f({\bf x}, {\bf p}, \tau )\)</span>满足如下Vlasov方程：
<span class="math display" id="eq:vlasov">\[\begin{align}
  \frac{\rm{d} f}{\rm{d} \tau}=\frac{\partial f}{\partial \tau} +
  \frac{{\bf p}}{ma}\cdot \nabla f - ma \nabla \phi \cdot \frac{\partial f}{\partial {\bf p}}=0\ .
  \tag{4.1}
\end{align}\]</span>
其中，<span class="math inline">\(m\)</span>为粒子质量，<span class="math inline">\(a\)</span>为尺度因子，<span class="math inline">\({\bf p}=am{\bf v}\)</span>为粒子动量。
<span class="math inline">\(\phi\)</span>为引力势，满足泊松方程：
<span class="math display" id="eq:poisson">\[\nabla^2\phi({\bf x}, \tau)=\frac{3}{2}\Omega_{\rm m}(\tau) \mathscr{H}^2(\tau )\delta({\bf x}, \tau)\ .
  \tag{4.2}\]</span> <span class="math inline">\(\delta\)</span>为密度涨落，
<span class="math display">\[\delta({{\bf x}, \tau}) \equiv \frac{\rho({{\bf x}, \tau})-\bar{\rho}}{\bar{\rho}}\ ,\]</span>
其取值范围为<span class="math inline">\(-1&lt;\delta&lt;\infty\)</span>。</p>
<div id="sec:ePT" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> 欧拉扰动理论<a href="结构增长.html#sec:ePT" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>直接求解Vlasov方程非常困难，我们通常更关心粒子空间分布的演化。
在欧拉坐标系下，相空间中的物质分布函数对动量求积分（即0阶矩），可以得到物质密度分布：
<span class="math display">\[\int \rm{d}^3{\bf p}f({\bf x}, {\bf p}, \tau)\equiv \rho({\bf x}, \tau)\ .
  \label{eqn:euler_delta}\]</span> 其1阶矩与2阶矩分别为 <span class="math display">\[\begin{align}
  &amp;\int \rm{d}^3 {\bf p}\frac{{\bf p}}{am} f({\bf x}, {\bf p}, \tau) \equiv \rho({\bf x}, \tau){\bf v}({\bf x}, \tau)\ ,\\
  &amp;\int \rm{d}^3 {\bf p}\frac{p_ip_j}{(am)^2} f({\bf x}, {\bf p}, \tau) \equiv
    \rho({\bf x}, \tau){\bf v}_i({\bf x}, \tau){\bf v}_j({\bf x}, \tau)+\sigma_{ij}({\bf x}, \tau)\ .
\end{align}\]</span> 由物质守恒可得连续性方程：
<span class="math display" id="eq:continuity">\[\begin{align}
  \frac{\partial \delta({\bf x}, \tau)}{\partial \tau} +\nabla \cdot \left[ 1+ \delta({\bf x}, \tau){\bf v}({\bf x}, \tau)\right]=0\ .
  \tag{4.3}
\end{align}\]</span>
Vlasov方程<a href="结构增长.html#eq:vlasov">(4.1)</a>与连续性方程<a href="结构增长.html#eq:continuity">(4.3)</a>联立可以给出描述动量守恒的欧拉方程：
<span class="math display" id="eq:eeq">\[\frac{\partial {\bf v}({\bf x}, \tau)}{\partial \tau} + \mathscr{H}(\tau) {\bf v}({\bf x}, \tau)+{\bf v}({\bf x}, \tau)\cdot\nabla {\bf v}({\bf x}, \tau)=
  -\nabla\phi({\bf x}, \tau)-\frac{1}{\rho}\nabla_j(\rho\sigma_{ij})\ .
  \tag{4.4}\]</span>
通过求解<a href="结构增长.html#eq:continuity">(4.3)</a>与<a href="结构增长.html#eq:eeq">(4.4)</a>可以得到密度场与速度场的演化方程。在线性近似下
<span class="math display">\[\begin{align}
  &amp;\frac{\partial \delta({\bf x}, \tau)}{\partial \tau}+\theta({\bf x}, \tau)=0\ ,\\
  &amp;\frac{\partial {\bf v}({\bf x}, \tau)}{\partial\tau}+\mathscr{H}(\tau) {\bf v}({\bf x}, \tau)=-\nabla \phi({\bf x}, \tau)\ .
\end{align}\]</span>
其中，<span class="math inline">\(\theta({\bf x}, \tau)\equiv \nabla\cdot {\bf v}({\bf x}, \tau)\)</span>为速度场的散度。
令<span class="math inline">\(\delta({\bf x}, \tau)=D(\tau)\delta({\bf x}, 0)\)</span>，其中，<span class="math inline">\(D(\tau)\)</span>为线性增长因子。
则<span class="math inline">\(\theta({\bf x}, \tau)=-\mathscr{H} f \delta({\bf x})\)</span>，其中，<span class="math inline">\(f\equiv \rm{d} \ln D/\rm{d} \ln a\)</span>为线性增长率，描述结构增长的快慢。
对于一个由<span class="math inline">\(\Omega_{\rm m}\)</span>与<span class="math inline">\(\Omega_{\Lambda}\)</span>主导的宇宙，
可以解得，<span class="math inline">\(f\approx \Omega_{\rm m}^{0.55}(z)\)</span>。 密度场满足方程： [^8]
<span class="math display">\[\ddot{\delta}+\left(\frac{3}{a}+\frac{\dot{H}}{H}\right)\dot{\delta}-
  \left( \frac{3}{2}\frac{\Omega_0 H_0^2}{H^2 a^3}\right)
  \left(\frac{\delta}{a^2}\right)=0\ .\]</span></p>
</div>
<div id="sec:LPT" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> 拉格朗日扰动理论<a href="结构增长.html#sec:LPT" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>欧拉方法可以通过微扰逐阶求解非线性扰动。在拉格朗日坐标下，也可以近似求解非线性扰动。
假设粒子初始位置为<span class="math inline">\({\bf q}\)</span>，在经历时间<span class="math inline">\(\tau\)</span>后，其最终位置<span class="math inline">\({\bf x}\)</span>可以由位移场<span class="math inline">\(\mathbf{\Psi}\)</span>表示为
<span class="math display">\[{\bf x}(\tau)={\bf q}+\mathbf{\Psi}({\bf q}，\tau)\ .\]</span> 位移场的运动方程为
<span class="math display" id="eq:eom">\[\frac{\rm{d}^2{\bf x}}{\rm{d}\tau^2}+\mathscr{H}(\tau)\frac{\rm{d} {\bf x}}{\rm{d} \tau}=-\nabla \phi\ ,
  \tag{4.5}\]</span>
<span class="math inline">\(\phi\)</span>为引力势，满足泊松方程<a href="结构增长.html#eq:poisson">(4.2)</a>。 对上式取散度可得
<span class="math display">\[J({\bf q}, \tau)\nabla\cdot \left[\frac{\rm{d}^2\mathbf{\Psi}}{\rm{d} \tau^2}+\mathscr{H}(\tau)\frac{\rm{d}\mathbf{\Psi}}{\rm{d} \tau}\right]
  =\frac{3}{2}\Omega_{\rm m}\mathscr{H}^2(J-1)\ .\]</span>
欧拉空间与拉格朗日空间质量守恒，有<span class="math inline">\(\bar{\rho}(1+\delta({\bf x}))\rm{d}^3x=\bar{\rho}\rm{d}^3q\)</span>。
因此
<span class="math display">\[1+\delta({\bf x})=\frac{1}{|\delta_{ij}+\Psi_{i, j}|}\equiv \frac{1}{J({\bf q}, \tau)}\ ,\]</span>
其中，<span class="math inline">\(\Psi_{i, j}\equiv \partial \Psi_i/\partial {\bf q}_j\)</span>，<span class="math inline">\(J\)</span>为欧拉空间转换到拉格朗日空间的雅可比矩阵。
位移场可以展开为<span class="math inline">\(\mathbf{\Psi}=\mathbf{\Psi}^{(1)}+\mathbf{\Psi}^{(2)}+\mathbf{\Psi}^{(3)}+\cdots\)</span>。
运动方程<a href="结构增长.html#eq:eom">(4.5)</a>在一阶线性近似时的解满足：
<span class="math display">\[\nabla_q\cdot \mathbf{\Psi}^{(1)} = -D(\tau)\delta({\bf q})\ .\]</span>
其中，<span class="math inline">\(D\)</span>为线性结构增长因子。 此时
<span class="math display">\[1+\delta({\bf x}, \tau)=\frac{1}{[1-\lambda_1D(\tau)][1-\lambda_2D(\tau)][1-\lambda_3D(\tau)]}\ .\]</span>
其中，<span class="math inline">\(\lambda_i, \ i=1, 2, 3\)</span>为<span class="math inline">\(\Psi_{i, j}\)</span>的本征值。
该近似也被称为Zeldovich近似(ZA)。</p>
</div>
</div>
<div id="n体数值模拟与非线性结构形成" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> N体数值模拟与非线性结构形成<a href="结构增长.html#n体数值模拟与非线性结构形成" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="n体数值模拟简介" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> N体数值模拟简介<a href="结构增长.html#n体数值模拟简介" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>如前所述，当演化进入非线性尺度后，传统的扰动理论以及解析模型已经无法精确描述此时的结构，需要借助数值模拟对结构演化进行计算。
通常数值模拟可以分为两大类：N体数值模拟与流体动力学(Hydrodynamical)数值模拟。
这些模拟在一定体积的三维盒子内模拟结构的形成及演化。
流体动力学模拟在星系形成及演化中应用更加广泛，通常有两种类型，一是基于平滑粒子(Smoothed-Particle
Hydrodynamics, SPH)，
一是基于格点(Grid-based)。
这里主要介绍与宇宙大尺度结构增长更相关的N体数值模拟。
N体数值模拟将物质视为离散分布的无碰撞粒子，每个粒子都携带一定质量，并且具有一定半径，在该半径内质量服从某种平滑分布。
模拟过程大致分为以下几步：</p>
<div id="设定初始条件" class="section level5 hasAnchor" number="4.2.1.0.1">
<h5><span class="header-section-number">4.2.1.0.1</span> 1. 设定初始条件。<a href="结构增长.html#设定初始条件" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>初始条件一般设定在高红移处。 生成初始条件的方法有很多，
通常利用给定的根据功率谱，根据ZA或2阶拉格朗日扰动理论(2LPT)产生对应红移处的位移场，
进而生成初始的密度场及速度场。</p>
</div>
<div id="计算粒子受力" class="section level5 hasAnchor" number="4.2.1.0.2">
<h5><span class="header-section-number">4.2.1.0.2</span> 2. 计算粒子受力。<a href="结构增长.html#计算粒子受力" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>粒子之间只存在引力，引力为长程力，因此在N体系统中，每两个粒子之间都需要计算一次相互作用。
对第<span class="math inline">\(i\)</span>个粒子，
<span class="math display">\[{\bf F}_i=-\sum_{j\neq i} G \frac{{\bf r}_i-{\bf r}_j}{|{\bf r}_i-{\bf r}_j|^3}\ ,\]</span>
这里假定了粒子具有单位质量。
<span class="math inline">\(\sum_{j\neq i}\)</span>需要对所有<span class="math inline">\(j\neq i\)</span>的粒子进行求和。
这种计算方法称为PP(Particle-Particle)算法。
PP算法的复杂度为<span class="math inline">\(\mathscr{O}(N^2)\)</span>，实际运用非常耗时，因此数值上衍生出了多种更快求解作用力的方法。</p>
<ul>
<li><p>树算法(Tree)。
提出了八叉树算法。首先将盒子8等分，若子格子中的粒子数目多于1个，那么将子格子继续8等分，
以此类推，直至每个格子中最多只包含1个粒子。
从最大格点到最小格点，特征长度依次减半。
在计算受力时，从最大格点开始遍历，通过格子的大小及与粒子的距离来控制计算精度。
设格子的特征长度为<span class="math inline">\(\ell\)</span>，格子相对某一粒子的距离为<span class="math inline">\(d\)</span>，
若格子对该粒子的张角<span class="math inline">\(\theta=\ell/d\)</span>小于设定的阈值，
则将该格子内所有粒子视为一个大质量粒子进行一次计算，否则进入下一层格子。
树算法的计算复杂度为<span class="math inline">\(\mathscr{O}(N\log N)\)</span>，缺点是需要消耗大量内存。</p></li>
<li><p>PM(Particle-Mesh)算法。
PM算法将盒子均分为若干个网格，将粒子对格点距离作为权重为邻近格点赋值，得到一个平滑分布的密度场<span class="math inline">\(\rho({\bf x})\)</span>。
然后计算每个格点的受力
<span class="math inline">\({\bf F}_i=-\nabla \phi_i\)</span>，其中，<span class="math inline">\(\phi_i\)</span>为第<span class="math inline">\(i\)</span>个格点所在位置的引力势，
可通过求解泊松方程确定<span class="math inline">\(\nabla^2\phi=4\pi G\rho({\bf x})\)</span>。
在傅立叶空间中，泊松方程变为
<span class="math inline">\(-k^2\phi({\bf k})=4\pi G \rho({\bf k})\)</span>，格点受力<span class="math inline">\({\bf F}_i=-i\phi({\bf k}){\bf k}\)</span>。
如果盒子的大小远远大于感兴趣的尺度，那么<span class="math inline">\(\rho({\bf k})\)</span>可以通过快速傅立叶变换(FFT)计算，显著提高计算速度。
最后，将格点受力用差值方法返还到粒子上。
PM算法的复杂度接近<span class="math inline">\(\mathscr{O}(N)\)</span>，但是格点数目会严重限制计算精度，想提高精度需要消耗大量内存及CPU。</p></li>
<li><p>混合算法。
为了在保证精度的同时提高计算速度，人们通常会混合使用上述的各种算法，如P<span class="math inline">\(^3\)</span>M(Particle-Particle-Particle-Mesh)。
P<span class="math inline">\(^3\)</span>M算法结合了PP算法与PM算法，在计算较近粒子间的受力时，采取PP算法；而在计算较远粒子间受力时，采取PM算法。
P<span class="math inline">\(^3\)</span>M算法是运用最广泛的方法之一，
如下文中将要介绍的CosmicGrowth数值模拟。
除P<span class="math inline">\(^3\)</span>M外，还有结合树算法与PM算法的tree-PM算法，如Gadget-2。</p></li>
</ul>
</div>
<div id="更新每个粒子的位置及速度信息" class="section level5 hasAnchor" number="4.2.1.0.3">
<h5><span class="header-section-number">4.2.1.0.3</span> 3. 更新每个粒子的位置及速度信息。<a href="结构增长.html#更新每个粒子的位置及速度信息" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>得到每个粒子受力后，需要计算下一时刻粒子的位置与速度。
为了保证计算收敛，满足能量守恒等条件，通常需要用到精确到二阶的时间积分器(integrator)，如Leapfrog，速度和位置信息交替更新，每次移动半个时间步长。</p>
</div>
<div id="重复2-3步至模拟结束" class="section level5 hasAnchor" number="4.2.1.0.4">
<h5><span class="header-section-number">4.2.1.0.4</span> 4. 重复2-3步至模拟结束。<a href="结构增长.html#重复2-3步至模拟结束" class="anchor-section" aria-label="Anchor link to header"></a></h5>
</div>
<div id="cosmicgrowth系列数值模拟" class="section level5 hasAnchor" number="4.2.1.0.5">
<h5><span class="header-section-number">4.2.1.0.5</span> CosmicGrowth系列数值模拟<a href="结构增长.html#cosmicgrowth系列数值模拟" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>表<a href="结构增长.html#tab:cosmpar">4.1</a>与<a href="结构增长.html#tab:simupar">4.2</a>列出了本文中用到的CosmicGrowth系列数值模拟的基本参数。
CosmicGrowth运行的为P<span class="math inline">\(^3\)</span>M代码。
本文选取了其中两组不同参数的标准宇宙学模拟，Planck及WMAP。</p>
<table>
<caption><span id="tab:cosmpar">Table 4.1: </span> Cosmological model parameters of CosmicGrowth Simulations.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="right"><span class="math inline">\(\Omega_b\)</span> $</th>
<th>_c$ $</th>
<th align="left">mega_{}$ <span class="math inline">\(h\)</span></th>
<th align="center"><span class="math inline">\(n_s\)</span></th>
<th align="right">$</th>
<th align="left">_8$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Planck <span class="math inline">\(\Lambda\)</span>CDM</td>
<td align="right">0.0487</td>
<td>0.2663</td>
<td align="left">0.685 0</td>
<td align="center">.673 0</td>
<td align="right">.9603</td>
<td align="left">0.829</td>
</tr>
<tr class="even">
<td align="left">WMAP <span class="math inline">\(\Lambda\)</span>CDM</td>
<td align="right">0.0445</td>
<td>0.2235</td>
<td align="left">0.732 0</td>
<td align="center">.71 0</td>
<td align="right">.968</td>
<td align="left">0.83</td>
</tr>
</tbody>
</table>
<table>
<caption><span id="tab:simupar">Table 4.2: </span> Simulation paramters of CosmicGrowth Simulations.</caption>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left"><span class="math inline">\(N_\text{p}\)</span></th>
<th align="center"><span class="math inline">\(L\)</span></th>
<th align="right"><span class="math inline">\(\rm{d} a\)</span></th>
<th align="right"><span class="math inline">\(\eta\)</span></th>
<th align="right"><span class="math inline">\(z_i\)</span></th>
<th align="right"><span class="math inline">\(N_\text{step}\)</span></th>
<th align="right"><span class="math inline">\(z_{\text{out, 1}}\)</span></th>
<th align="right"><span class="math inline">\(N_{\text{snap}}\)</span></th>
<th align="right">Realizations</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Planck_2048_400</td>
<td align="left"><span class="math inline">\(2048^3\)</span></td>
<td align="center">400</td>
<td align="right">0.0288</td>
<td align="right">0.007</td>
<td align="right">144</td>
<td align="right">5000</td>
<td align="right">16.87</td>
<td align="right">100</td>
<td align="right">1</td>
<td></td>
</tr>
<tr class="even">
<td align="left">Planck_2048_1200</td>
<td align="left"><span class="math inline">\(2048^3\)</span></td>
<td align="center">1200</td>
<td align="right">0.06</td>
<td align="right">0.03</td>
<td align="right">72</td>
<td align="right">1200</td>
<td align="right">7.30</td>
<td align="right">24</td>
<td align="right">1</td>
<td></td>
</tr>
<tr class="odd">
<td align="left">WMAP_2048_400</td>
<td align="left"><span class="math inline">\(2048^3\)</span></td>
<td align="center">400</td>
<td align="right">0.0288</td>
<td align="right">0.007</td>
<td align="right">144</td>
<td align="right">5000</td>
<td align="right">16.87</td>
<td align="right">100</td>
<td align="right">1</td>
<td></td>
</tr>
<tr class="even">
<td align="left">WMAP_2048_1200</td>
<td align="left"><span class="math inline">\(2048^3\)</span></td>
<td align="center">1200</td>
<td align="right">0.06</td>
<td align="right">0.03</td>
<td align="right">72</td>
<td align="right">1200</td>
<td align="right">7.30</td>
<td align="right">24</td>
<td align="right">1</td>
<td></td>
</tr>
<tr class="odd">
<td align="left">WMAP_3072_600</td>
<td align="left"><span class="math inline">\(3072^3\)</span></td>
<td align="center">600</td>
<td align="right">0.0288</td>
<td align="right">0.01</td>
<td align="right">144</td>
<td align="right">5000</td>
<td align="right">16.87</td>
<td align="right">100</td>
<td align="right">3</td>
<td></td>
</tr>
<tr class="even">
<td align="left">WMAP_3072_1200</td>
<td align="left"><span class="math inline">\(3072^3\)</span></td>
<td align="center">1200</td>
<td align="right">0.0288</td>
<td align="right">0.02</td>
<td align="right">144</td>
<td align="right">5000</td>
<td align="right">16.87</td>
<td align="right">100</td>
<td align="right">1</td>
<td></td>
</tr>
</tbody>
</table>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:snap6411"></span>
<img src="intro/snap.png" alt="Modified Graivity Theories."  />
<p class="caption">
Figure 4.1: Modified Graivity Theories.
</p>
</div>
<p>图<a href="结构增长.html#fig:snap6411">4.1</a>展示了CosmicGrowth中一个数值模拟在不同红移时的切片。
厚度为<span class="math inline">\(20\rm{Mpc}/h\)</span>。在低红移处的宇宙物质结构形似神经网络，我们称之为宇宙网（Cosmic
Web）。 宇宙网中的低密度区域为Void；
高密度区域主要由丝状结构的filament、以及filament交汇处的结点（knots）组成。
在这些高密度区域中会形成暗晕(halo)、子暗晕等高度非线性结构。</p>
</div>
</div>
<div id="暗晕" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> 暗晕<a href="结构增长.html#暗晕" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>暗晕是结构演化进入非线性阶段后形成的一类维里化结构。
描述暗晕形成最简单的理论是球塌缩模型。
在Einstein-de Sitter宇宙(<span class="math inline">\(\Omega_{\Lambda}=0\)</span>)中，
球塌缩模型给出的暗晕密度为<span class="math inline">\(\Delta_{\rm vir}= 18\pi^2\approx 178\)</span>倍的背景密度。
如果半径<span class="math inline">\(R\)</span>内的球形区域在红移<span class="math inline">\(z\)</span>时开始塌缩，则线性理论给出<span class="math inline">\(z\)</span>时区域内的平均密度为
<span class="math display">\[\delta_c(z)=\frac{3(1+z)}{5}\left(\frac{3\pi}{2}\right)^{2/3}\ .\]</span>
红移<span class="math inline">\(z=0\)</span>时，<span class="math inline">\(\delta_c(z=0)\approx 1.686\)</span>。
一个直接反映结构增长的统计量为暗晕的质量函数，其有多种表述形式，
常使用<span class="math inline">\(\rm{d} n/\rm{d} M\)</span>或<span class="math inline">\(\rm{d} n/\rm{d} \ln M\)</span>，
其中，<span class="math inline">\(M\)</span>表示暗晕质量，<span class="math inline">\(n\)</span>表示暗晕个数。
显然，暗晕质量函数依赖红移与宇宙学。 总的来说，暗晕质量函数可以表示为
<span class="math display">\[\frac{\rm{d} n}{\rm{d} M} = f(\sigma)\frac{\rho_{\rm m}}{M}\frac{\rm{d} \ln \sigma^{-1}}{\rm{d} M}\ ,\]</span>
其中，<span class="math inline">\(\sigma\)</span>为包含质量<span class="math inline">\(M\)</span>的球体内的方均根扰动，<span class="math inline">\(f(\sigma)\)</span>称为暗晕乘函数。
根据线性理论及球塌缩模型推导出了暗晕的质量分布函数，给出的乘函数的形式为
<span class="math display">\[f(\sigma)=\sqrt{\frac{2}{\pi}}\frac{\delta_c}{\sigma}\exp\left(-\frac{\delta_c^2}{2\sigma^2}\right)\ .\]</span>
但是，数值模拟显示，<span class="math inline">\(\delta_c\)</span>与暗晕质量函数的实际值要明显大于上述理论的预言。
随后，等众多工作借助数值模拟，
在不同宇宙学下，给出了不同乘函数的拟合结果，具体形式可参考。</p>
<p> <br />
</p>
</div>
<div id="其他方法" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> 其他方法<a href="结构增长.html#其他方法" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>N体数值模拟的最大弊端是需要消耗大量计算资源，且随着观测体积的增大，运算难度迅速增长。
因此，人们提出了许多替代方法，在满足精度要求的同时，节省计算成本，加快计算速度。
如FastPM，COLA等快速算法，
或者利用机器学习等方法快速生成模拟样本。</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="宇宙学观测.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="附录.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/03-growth-rate.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
